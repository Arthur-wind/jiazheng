{"remainingRequest":"C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\src\\components\\common\\ExcelFileUpload.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\src\\components\\common\\ExcelFileUpload.vue","mtime":1723129192000},{"path":"C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yzfen\\Desktop\\HomeServicePlatform-main\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHN0b3JhZ2UgZnJvbSAiQC91dGlscy9zdG9yYWdlIjsKaW1wb3J0IGJhc2UgZnJvbSAiQC91dGlscy9iYXNlIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDmn6XnnIvlpKflm74KICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIC8vIOafpeeci+Wkp+WbvgogICAgICBkaWFsb2dJbWFnZVVybDogIiIsCiAgICAgIC8vIOe7hOS7tua4suafk+WbvueJh+eahOaVsOe7hOWtl+aute+8jOacieeJueauiuagvOW8j+imgeaxggogICAgICBmaWxlTGlzdDogW10sCiAgICAgIGZpbGVVcmxMaXN0OiBbXSwKICAgICAgbXlIZWFkZXJzOiB7fQogICAgfTsKICB9LAogIHByb3BzOiBbInRpcCIsICJhY3Rpb24iLCAibGltaXQiLCAibXVsdGlwbGUiLCAiZmlsZVVybHMiXSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgICB0aGlzLm15SGVhZGVycyA9IHsKICAgICAgJ1Rva2VuJzogc3RvcmFnZS5nZXQoIlRva2VuIikKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgZmlsZVVybHM6IGZ1bmN0aW9uICh2YWwsIG9sZFZhbCkgewogICAgICAvLyAgIGNvbnNvbGUubG9nKCJuZXc6ICVzLCBvbGQ6ICVzIiwgdmFsLCBvbGRWYWwpOwogICAgICB0aGlzLmluaXQoKTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDorqHnrpflsZ7mgKfnmoQgZ2V0dGVyCiAgICBnZXRBY3Rpb25Vcmw6IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gcmV0dXJuIGJhc2UudXJsICsgdGhpcy5hY3Rpb24gKyAiP3Rva2VuPSIgKyBzdG9yYWdlLmdldCgidG9rZW4iKTsKICAgICAgcmV0dXJuIGAvJHt0aGlzLiRiYXNlLm5hbWV9L2AgKyB0aGlzLmFjdGlvbjsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOWIneWni+WMlgogICAgaW5pdCgpIHsKICAgICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLmZpbGVVcmxzKTsKICAgICAgaWYgKHRoaXMuZmlsZVVybHMpIHsKICAgICAgICB0aGlzLmZpbGVVcmxMaXN0ID0gdGhpcy5maWxlVXJscy5zcGxpdCgiLCIpOwogICAgICAgIGxldCBmaWxlQXJyYXkgPSBbXTsKICAgICAgICB0aGlzLmZpbGVVcmxMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICB2YXIgdXJsID0gaXRlbTsKICAgICAgICAgIHZhciBuYW1lID0gaW5kZXg7CiAgICAgICAgICB2YXIgZmlsZSA9IHsKICAgICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgICAgdXJsOiB1cmwKICAgICAgICAgIH07CiAgICAgICAgICBmaWxlQXJyYXkucHVzaChmaWxlKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLnNldEZpbGVMaXN0KGZpbGVBcnJheSk7CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVCZWZvcmVVcGxvYWQoZmlsZSkge30sCiAgICAvLyDkuIrkvKDmlofku7bmiJDlip/lkI7miafooYwKICAgIGhhbmRsZVVwbG9hZFN1Y2Nlc3MocmVzLCBmaWxlLCBmaWxlTGlzdCkgewogICAgICBpZiAocmVzICYmIHJlcy5jb2RlID09PSAwKSB7CiAgICAgICAgZmlsZUxpc3RbZmlsZUxpc3QubGVuZ3RoIC0gMV1bInVybCJdID0gInVwbG9hZC8iICsgZmlsZS5yZXNwb25zZS5maWxlOwogICAgICAgIHRoaXMuc2V0RmlsZUxpc3QoZmlsZUxpc3QpOwogICAgICAgIHRoaXMuJGVtaXQoImNoYW5nZSIsIHRoaXMuZmlsZVVybExpc3Quam9pbigiLCIpKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuaWh+S7tuWvvOWFpeaIkOWKnyIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDlm77niYfkuIrkvKDlpLHotKUKICAgIGhhbmRsZVVwbG9hZEVycihlcnIsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuaWh+S7tuWvvOWFpeWksei0pSIpOwogICAgfSwKICAgIC8vIOenu+mZpOWbvueJhwogICAgaGFuZGxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuc2V0RmlsZUxpc3QoZmlsZUxpc3QpOwogICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aGlzLmZpbGVVcmxMaXN0LmpvaW4oIiwiKSk7CiAgICB9LAogICAgLy8g5p+l55yL5aSn5Zu+CiAgICBoYW5kbGVVcGxvYWRQcmV2aWV3KGZpbGUpIHsKICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIC8vIOmZkOWItuWbvueJh+aVsOmHjwogICAgaGFuZGxlRXhjZWVkKGZpbGVzLCBmaWxlTGlzdCkgewogICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoYOacgOWkmuS4iuS8oCR7dGhpcy5saW1pdH3lvKDlm77niYdgKTsKICAgIH0sCiAgICAvLyDph43mlrDlr7lmaWxlTGlzdOi/m+ihjOi1i+WAvAogICAgc2V0RmlsZUxpc3QoZmlsZUxpc3QpIHsKICAgICAgdmFyIGZpbGVBcnJheSA9IFtdOwogICAgICB2YXIgZmlsZVVybEFycmF5ID0gW107CiAgICAgIC8vIOacieS6m+WbvueJh+S4jeaYr+WFrOW8gOeahO+8jOaJgOS7pemcgOimgeaQuuW4pnRva2Vu5L+h5oGv5YGa5p2D6ZmQ5qCh6aqMCiAgICAgIHZhciB0b2tlbiA9IHN0b3JhZ2UuZ2V0KCJ0b2tlbiIpOwogICAgICBsZXQgX3RoaXMgPSB0aGlzOwogICAgICBmaWxlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgIHZhciB1cmwgPSBpdGVtLnVybC5zcGxpdCgiPyIpWzBdOwogICAgICAgIGlmICghdXJsLnN0YXJ0c1dpdGgoImh0dHAiKSkgewogICAgICAgICAgdXJsID0gX3RoaXMuJGJhc2UudXJsICsgdXJsOwogICAgICAgIH0KICAgICAgICB2YXIgbmFtZSA9IGl0ZW0ubmFtZTsKICAgICAgICB2YXIgZmlsZSA9IHsKICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICB1cmw6IHVybCArICI/dG9rZW49IiArIHRva2VuCiAgICAgICAgfTsKICAgICAgICBmaWxlQXJyYXkucHVzaChmaWxlKTsKICAgICAgICBmaWxlVXJsQXJyYXkucHVzaCh1cmwpOwogICAgICB9KTsKICAgICAgdGhpcy5maWxlTGlzdCA9IGZpbGVBcnJheTsKICAgICAgdGhpcy5maWxlVXJsTGlzdCA9IGZpbGVVcmxBcnJheTsKICAgIH0KICB9Cn07"},{"version":3,"names":["storage","base","data","dialogVisible","dialogImageUrl","fileList","fileUrlList","myHeaders","props","mounted","init","get","watch","fileUrls","val","oldVal","computed","getActionUrl","$base","name","action","methods","split","fileArray","forEach","item","index","url","file","push","setFileList","handleBeforeUpload","handleUploadSuccess","res","code","length","response","$emit","join","$message","success","error","msg","handleUploadErr","err","handleRemove","handleUploadPreview","handleExceed","files","warning","limit","fileUrlArray","token","_this","startsWith"],"sources":["src/components/common/ExcelFileUpload.vue"],"sourcesContent":["<template>\n  <div>\n    <!-- 上传文件组件 -->\n    <el-upload\n      ref=\"upload\"\n      :action=\"getActionUrl\"\n      list-type=\"picture-card\"\n      accept=\".xls,.xlsx\"\n      :limit=\"limit\"\n      :headers=\"myHeaders\"\n      :file-list=\"fileList\"\n      :on-exceed=\"handleExceed\"\n      :on-preview=\"handleUploadPreview\"\n      :on-remove=\"handleRemove\"\n      :on-success=\"handleUploadSuccess\"\n      :on-error=\"handleUploadErr\"\n      :before-upload=\"handleBeforeUpload\"\n    >\n      <i class=\"el-icon-plus\"></i>\n      <div slot=\"tip\" class=\"el-upload__tip\" style=\"color:#838fa1;\">{{tip}}</div>\n    </el-upload>\n    <el-dialog :visible.sync=\"dialogVisible\" size=\"tiny\" append-to-body>\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport storage from \"@/utils/storage\";\nimport base from \"@/utils/base\";\nexport default {\n  data() {\n    return {\n      // 查看大图\n      dialogVisible: false,\n      // 查看大图\n      dialogImageUrl: \"\",\n      // 组件渲染图片的数组字段，有特殊格式要求\n      fileList: [],\n      fileUrlList: [],\n      myHeaders:{}\n    };\n  },\n  props: [\"tip\", \"action\", \"limit\", \"multiple\", \"fileUrls\"],\n  mounted() {\n    this.init();\n    this.myHeaders= {\n      'Token':storage.get(\"Token\")\n    }\n  },\n  watch: {\n    fileUrls: function(val, oldVal) {\n      //   console.log(\"new: %s, old: %s\", val, oldVal);\n      this.init();\n    }\n  },\n  computed: {\n    // 计算属性的 getter\n    getActionUrl: function() {\n      // return base.url + this.action + \"?token=\" + storage.get(\"token\");\n      return `/${this.$base.name}/` + this.action;\n    }\n  },\n  methods: {\n    // 初始化\n    init() {\n      //   console.log(this.fileUrls);\n      if (this.fileUrls) {\n        this.fileUrlList = this.fileUrls.split(\",\");\n        let fileArray = [];\n        this.fileUrlList.forEach(function(item, index) {\n          var url = item;\n          var name = index;\n          var file = {\n            name: name,\n            url: url\n          };\n          fileArray.push(file);\n        });\n        this.setFileList(fileArray);\n      }\n    },\n    handleBeforeUpload(file) {\n    \n    },\n    // 上传文件成功后执行\n    handleUploadSuccess(res, file, fileList) {\n      if (res && res.code === 0) {\n        fileList[fileList.length - 1][\"url\"] = \"upload/\" + file.response.file;\n        this.setFileList(fileList);\n        this.$emit(\"change\", this.fileUrlList.join(\",\"));\n        this.$message.success(\"文件导入成功\");\n      } else {\n        this.$message.error(res.msg);\n      }\n    },\n    // 图片上传失败\n    handleUploadErr(err, file, fileList) {\n      this.$message.error(\"文件导入失败\");\n    },\n    // 移除图片\n    handleRemove(file, fileList) {\n      this.setFileList(fileList);\n      this.$emit(\"change\", this.fileUrlList.join(\",\"));\n    },\n    // 查看大图\n    handleUploadPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    // 限制图片数量\n    handleExceed(files, fileList) {\n      this.$message.warning(`最多上传${this.limit}张图片`);\n    },\n    // 重新对fileList进行赋值\n    setFileList(fileList) {\n      var fileArray = [];\n      var fileUrlArray = [];\n      // 有些图片不是公开的，所以需要携带token信息做权限校验\n      var token = storage.get(\"token\");\n      let _this = this;\n      fileList.forEach(function(item, index) {\n        var url = item.url.split(\"?\")[0];\n    if(!url.startsWith(\"http\")) {\n      url = _this.$base.url+url\n    }\n        var name = item.name;\n        var file = {\n          name: name,\n          url: url + \"?token=\" + token\n        };\n        fileArray.push(file);\n        fileUrlArray.push(url);\n      });\n      this.fileList = fileArray;\n      this.fileUrlList = fileUrlArray;\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n</style>\n\n"],"mappings":"AA2BA,OAAAA,OAAA;AACA,OAAAC,IAAA;AACA;EACAC,KAAA;IACA;MACA;MACAC,aAAA;MACA;MACAC,cAAA;MACA;MACAC,QAAA;MACAC,WAAA;MACAC,SAAA;IACA;EACA;EACAC,KAAA;EACAC,QAAA;IACA,KAAAC,IAAA;IACA,KAAAH,SAAA;MACA,SAAAP,OAAA,CAAAW,GAAA;IACA;EACA;EACAC,KAAA;IACAC,QAAA,WAAAA,CAAAC,GAAA,EAAAC,MAAA;MACA;MACA,KAAAL,IAAA;IACA;EACA;EACAM,QAAA;IACA;IACAC,YAAA,WAAAA,CAAA;MACA;MACA,gBAAAC,KAAA,CAAAC,IAAA,WAAAC,MAAA;IACA;EACA;EACAC,OAAA;IACA;IACAX,KAAA;MACA;MACA,SAAAG,QAAA;QACA,KAAAP,WAAA,QAAAO,QAAA,CAAAS,KAAA;QACA,IAAAC,SAAA;QACA,KAAAjB,WAAA,CAAAkB,OAAA,WAAAC,IAAA,EAAAC,KAAA;UACA,IAAAC,GAAA,GAAAF,IAAA;UACA,IAAAN,IAAA,GAAAO,KAAA;UACA,IAAAE,IAAA;YACAT,IAAA,EAAAA,IAAA;YACAQ,GAAA,EAAAA;UACA;UACAJ,SAAA,CAAAM,IAAA,CAAAD,IAAA;QACA;QACA,KAAAE,WAAA,CAAAP,SAAA;MACA;IACA;IACAQ,mBAAAH,IAAA,GAEA;IACA;IACAI,oBAAAC,GAAA,EAAAL,IAAA,EAAAvB,QAAA;MACA,IAAA4B,GAAA,IAAAA,GAAA,CAAAC,IAAA;QACA7B,QAAA,CAAAA,QAAA,CAAA8B,MAAA,2BAAAP,IAAA,CAAAQ,QAAA,CAAAR,IAAA;QACA,KAAAE,WAAA,CAAAzB,QAAA;QACA,KAAAgC,KAAA,gBAAA/B,WAAA,CAAAgC,IAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;MACA;QACA,KAAAD,QAAA,CAAAE,KAAA,CAAAR,GAAA,CAAAS,GAAA;MACA;IACA;IACA;IACAC,gBAAAC,GAAA,EAAAhB,IAAA,EAAAvB,QAAA;MACA,KAAAkC,QAAA,CAAAE,KAAA;IACA;IACA;IACAI,aAAAjB,IAAA,EAAAvB,QAAA;MACA,KAAAyB,WAAA,CAAAzB,QAAA;MACA,KAAAgC,KAAA,gBAAA/B,WAAA,CAAAgC,IAAA;IACA;IACA;IACAQ,oBAAAlB,IAAA;MACA,KAAAxB,cAAA,GAAAwB,IAAA,CAAAD,GAAA;MACA,KAAAxB,aAAA;IACA;IACA;IACA4C,aAAAC,KAAA,EAAA3C,QAAA;MACA,KAAAkC,QAAA,CAAAU,OAAA,aAAAC,KAAA;IACA;IACA;IACApB,YAAAzB,QAAA;MACA,IAAAkB,SAAA;MACA,IAAA4B,YAAA;MACA;MACA,IAAAC,KAAA,GAAApD,OAAA,CAAAW,GAAA;MACA,IAAA0C,KAAA;MACAhD,QAAA,CAAAmB,OAAA,WAAAC,IAAA,EAAAC,KAAA;QACA,IAAAC,GAAA,GAAAF,IAAA,CAAAE,GAAA,CAAAL,KAAA;QACA,KAAAK,GAAA,CAAA2B,UAAA;UACA3B,GAAA,GAAA0B,KAAA,CAAAnC,KAAA,CAAAS,GAAA,GAAAA,GAAA;QACA;QACA,IAAAR,IAAA,GAAAM,IAAA,CAAAN,IAAA;QACA,IAAAS,IAAA;UACAT,IAAA,EAAAA,IAAA;UACAQ,GAAA,EAAAA,GAAA,eAAAyB;QACA;QACA7B,SAAA,CAAAM,IAAA,CAAAD,IAAA;QACAuB,YAAA,CAAAtB,IAAA,CAAAF,GAAA;MACA;MACA,KAAAtB,QAAA,GAAAkB,SAAA;MACA,KAAAjB,WAAA,GAAA6C,YAAA;IACA;EACA;AACA","ignoreList":[]}]}